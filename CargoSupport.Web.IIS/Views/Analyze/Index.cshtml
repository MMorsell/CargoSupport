@model List<CargoSupport.Models.DatabaseModels.DataModel>;
@{
    ViewData["Title"] = "Analyze";
}

<div class="text-center">
    <input type="button" class="btn btn-primary" value="Visa data för en eller flera förare" onclick="location.href='@Url.Action("AllData", "Analyze")'" />
    <input disabled type="button" class="btn btn-primary" value="Visa alla förare under en chef" onclick="location.href='@Url.Action("DriversUnderMe", "Analyze")'" />
</div>

<div class="text-center">
    <div id="grid-wrapper" style="width:100%; height: 100%">
        <div id="myGrid" style="height: 100vw; width: 100vw;" class="ag-theme-alpine"></div>
    </div>
</div>

@section Scripts
{
    <script type="text/javascript" charset="utf-8">

        var allData = @Html.Raw(ViewBag.DataTable)
            console.log(allData);
        // specify the columns
        let columnDefs = [
            {
                headerName: "Namn", field: "FullName",
                cellRenderer: function (params) {
                    return '<a onclick=\'OpenDetailedInfo(this.WeekAvrWeight)\' style="color:blue;cursor: pointer;">' + params.value + '</a>'
                },
                sortable: true, filter: true, checkboxSelection: true
            },
            { headerName: "Veckans snitt vikt", field: "WeekAvrWeight", sortable: true, filter: true },
            { headerName: "Veckans snitt kunder", field: "WeekAvrCustomers", sortable: true, filter: true },
            { headerName: "Veckans snitt kördistans", field: "WeekAvrDistance", sortable: true, filter: true },
        ];

        // let the grid know which columns and what data to use
        let gridOptions = {
            columnDefs: columnDefs,
            rowData: allData
        };

        // lookup the container we want the Grid to use
        var eGridDiv = document.querySelector('#myGrid');

        // create the grid passing in the div to use together with the columns & data we want to use
        new agGrid.Grid(eGridDiv, gridOptions);

        function OpenDetailedInfo(row) {
            debugger;
            myWindow = window.open('Analyze/AllData', "_self")
        }
    </script>
}